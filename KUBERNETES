# Kubernetes Config

## Docker Images

Follow the instructions in SERVER_SETUP.md to ME_NGINX_CONFIG.md to clone the project and create images.

## Install Minikube and Kubectl

### Minikube

Download and install Minikube

```shell
curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64 

sudo install minikube-linux-amd64 /usr/local/bin/minikube
```

### Kubectl

Download and install Kubectl

```shell
curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl"

sudo install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl
```

### Start Minikube

```shell
minikube start

# Check status
minikube status

# See a list of all pods in the cluster
kubectl get pods -A

# See cluster info 
kubectl cluster-info
```

### Configure docker commands to run in Minikube

```shell
eval $(minikube docker-env)
```

## Create Deployments and Services

## Mongo

### mongo-deployment.yml

Create the following file:

```shell
apiVersion: apps/v1
kind: Deployment
metadata:
  name: mongo-deployment
  labels:
    app: mongo
spec:
  replicas: 1
  selector:
    matchLabels:
      app: mongo
  template:
    metadata:
      labels:
        app: mongo
    spec:
      containers:
      - name: mongo-container
        image: mongo
        ports:
        - containerPort: 27017
```

### mongo-service.yml

```shell
apiVersion: v1
kind: Service
metadata:
  name: mongo
spec:
  selector:
    app: mongo
  ports:
    - protocol: TCP
      port: 27017
      targetPort: 27017
```
